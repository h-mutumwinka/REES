{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 64, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/byiri/Music/RuralEducation/app/api/auth/login/route.ts"],"sourcesContent":["import { type NextRequest, NextResponse } from \"next/server\"\nimport Database from \"better-sqlite3\"\nimport crypto from \"crypto\"\nimport path from \"path\"\n\nlet db: Database.Database\n\nfunction getDb() {\n  if (!db) {\n    const dbPath = path.join(process.cwd(), \"rees.db\")\n    db = new Database(dbPath)\n  }\n  return db\n}\n\nfunction hashPassword(password: string): string {\n  return crypto.createHash(\"sha256\").update(password).digest(\"hex\")\n}\n\nexport async function POST(request: NextRequest) {\n  try {\n    const { email, password } = await request.json()\n\n    if (!email || !password) {\n      return NextResponse.json({ error: \"Email and password required\" }, { status: 400 })\n    }\n\n    const database = getDb()\n    const user = database.prepare(\"SELECT id, role, password FROM users WHERE email = ?\").get(email) as any\n\n    if (!user || user.password !== hashPassword(password)) {\n      return NextResponse.json({ error: \"Invalid credentials\" }, { status: 401 })\n    }\n\n    return NextResponse.json({\n      userId: user.id,\n      role: user.role,\n    })\n  } catch (error) {\n    return NextResponse.json({ error: \"Server error\" }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;;;;;AAEA,IAAI;AAEJ,SAAS;IACP,IAAI,CAAC,IAAI;QACP,MAAM,SAAS,4GAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI;QACxC,KAAK,IAAI,sIAAQ,CAAC;IACpB;IACA,OAAO;AACT;AAEA,SAAS,aAAa,QAAgB;IACpC,OAAO,gHAAM,CAAC,UAAU,CAAC,UAAU,MAAM,CAAC,UAAU,MAAM,CAAC;AAC7D;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,MAAM,QAAQ,IAAI;QAE9C,IAAI,CAAC,SAAS,CAAC,UAAU;YACvB,OAAO,2KAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAA8B,GAAG;gBAAE,QAAQ;YAAI;QACnF;QAEA,MAAM,WAAW;QACjB,MAAM,OAAO,SAAS,OAAO,CAAC,wDAAwD,GAAG,CAAC;QAE1F,IAAI,CAAC,QAAQ,KAAK,QAAQ,KAAK,aAAa,WAAW;YACrD,OAAO,2KAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAsB,GAAG;gBAAE,QAAQ;YAAI;QAC3E;QAEA,OAAO,2KAAY,CAAC,IAAI,CAAC;YACvB,QAAQ,KAAK,EAAE;YACf,MAAM,KAAK,IAAI;QACjB;IACF,EAAE,OAAO,OAAO;QACd,OAAO,2KAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAe,GAAG;YAAE,QAAQ;QAAI;IACpE;AACF"}}]
}