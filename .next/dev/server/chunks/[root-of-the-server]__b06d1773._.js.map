{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/byiri/Music/RuralEducation/app/api/student/dashboard/route.ts"],"sourcesContent":["import { type NextRequest, NextResponse } from \"next/server\"\nimport Database from \"better-sqlite3\"\nimport path from \"path\"\n\nlet db: Database.Database\n\nfunction getDb() {\n  if (!db) {\n    const dbPath = path.join(process.cwd(), \"rees.db\")\n    db = new Database(dbPath)\n  }\n  return db\n}\n\nexport async function GET(request: NextRequest) {\n  try {\n    const { searchParams } = new URL(request.url)\n    const userId = searchParams.get(\"userId\")\n\n    if (!userId) {\n      return NextResponse.json({ error: \"User ID required\" }, { status: 400 })\n    }\n\n    const database = getDb()\n    const user = database.prepare(\"SELECT name FROM users WHERE id = ? AND role = ?\").get(userId, \"student\") as any\n\n    if (!user) {\n      return NextResponse.json({ error: \"Student not found\" }, { status: 404 })\n    }\n\n    const courses = database\n      .prepare(`\n      SELECT c.id, c.title, c.description, c.subject, c.grade_level\n      FROM courses c\n      JOIN enrollments e ON c.id = e.course_id\n      WHERE e.student_id = ?\n    `)\n      .all(userId) as any[]\n\n    return NextResponse.json({\n      name: user.name,\n      courses,\n    })\n  } catch (error) {\n    return NextResponse.json({ error: \"Server error\" }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEA,IAAI;AAEJ,SAAS;IACP,IAAI,CAAC,IAAI;QACP,MAAM,SAAS,4GAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI;QACxC,KAAK,IAAI,sIAAQ,CAAC;IACpB;IACA,OAAO;AACT;AAEO,eAAe,IAAI,OAAoB;IAC5C,IAAI;QACF,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;QAC5C,MAAM,SAAS,aAAa,GAAG,CAAC;QAEhC,IAAI,CAAC,QAAQ;YACX,OAAO,2KAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAmB,GAAG;gBAAE,QAAQ;YAAI;QACxE;QAEA,MAAM,WAAW;QACjB,MAAM,OAAO,SAAS,OAAO,CAAC,oDAAoD,GAAG,CAAC,QAAQ;QAE9F,IAAI,CAAC,MAAM;YACT,OAAO,2KAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAoB,GAAG;gBAAE,QAAQ;YAAI;QACzE;QAEA,MAAM,UAAU,SACb,OAAO,CAAC,CAAC;;;;;IAKZ,CAAC,EACE,GAAG,CAAC;QAEP,OAAO,2KAAY,CAAC,IAAI,CAAC;YACvB,MAAM,KAAK,IAAI;YACf;QACF;IACF,EAAE,OAAO,OAAO;QACd,OAAO,2KAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAe,GAAG;YAAE,QAAQ;QAAI;IACpE;AACF"}}]
}