{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/byiri/Music/RuralEducation/app/api/admin/dashboard/route.ts"],"sourcesContent":["import { type NextRequest, NextResponse } from \"next/server\"\nimport Database from \"better-sqlite3\"\nimport path from \"path\"\n\nlet db: Database.Database\n\nfunction getDb() {\n  if (!db) {\n    const dbPath = path.join(process.cwd(), \"rees.db\")\n    db = new Database(dbPath)\n  }\n  return db\n}\n\nexport async function GET(request: NextRequest) {\n  try {\n    const { searchParams } = new URL(request.url)\n    const userId = searchParams.get(\"userId\")\n\n    if (!userId) {\n      return NextResponse.json({ error: \"User ID required\" }, { status: 400 })\n    }\n\n    const database = getDb()\n    const user = database.prepare(\"SELECT name FROM users WHERE id = ? AND role = ?\").get(userId, \"admin\") as any\n\n    if (!user) {\n      return NextResponse.json({ error: \"Admin not found\" }, { status: 404 })\n    }\n\n    const totalUsers = (database.prepare(\"SELECT COUNT(*) as count FROM users\").get() as any).count\n    const totalStudents = (database.prepare(\"SELECT COUNT(*) as count FROM users WHERE role = 'student'\").get() as any)\n      .count\n    const totalTeachers = (database.prepare(\"SELECT COUNT(*) as count FROM users WHERE role = 'teacher'\").get() as any)\n      .count\n    const totalCourses = (database.prepare(\"SELECT COUNT(*) as count FROM courses\").get() as any).count\n\n    const users = database.prepare(\"SELECT id, name, email, role FROM users\").all() as any[]\n\n    return NextResponse.json({\n      name: user.name,\n      stats: {\n        totalUsers,\n        totalStudents,\n        totalTeachers,\n        totalCourses,\n      },\n      users,\n    })\n  } catch (error) {\n    return NextResponse.json({ error: \"Server error\" }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEA,IAAI;AAEJ,SAAS;IACP,IAAI,CAAC,IAAI;QACP,MAAM,SAAS,4GAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,IAAI;QACxC,KAAK,IAAI,sIAAQ,CAAC;IACpB;IACA,OAAO;AACT;AAEO,eAAe,IAAI,OAAoB;IAC5C,IAAI;QACF,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;QAC5C,MAAM,SAAS,aAAa,GAAG,CAAC;QAEhC,IAAI,CAAC,QAAQ;YACX,OAAO,2KAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAmB,GAAG;gBAAE,QAAQ;YAAI;QACxE;QAEA,MAAM,WAAW;QACjB,MAAM,OAAO,SAAS,OAAO,CAAC,oDAAoD,GAAG,CAAC,QAAQ;QAE9F,IAAI,CAAC,MAAM;YACT,OAAO,2KAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAkB,GAAG;gBAAE,QAAQ;YAAI;QACvE;QAEA,MAAM,aAAa,AAAC,SAAS,OAAO,CAAC,uCAAuC,GAAG,GAAW,KAAK;QAC/F,MAAM,gBAAgB,AAAC,SAAS,OAAO,CAAC,8DAA8D,GAAG,GACtG,KAAK;QACR,MAAM,gBAAgB,AAAC,SAAS,OAAO,CAAC,8DAA8D,GAAG,GACtG,KAAK;QACR,MAAM,eAAe,AAAC,SAAS,OAAO,CAAC,yCAAyC,GAAG,GAAW,KAAK;QAEnG,MAAM,QAAQ,SAAS,OAAO,CAAC,2CAA2C,GAAG;QAE7E,OAAO,2KAAY,CAAC,IAAI,CAAC;YACvB,MAAM,KAAK,IAAI;YACf,OAAO;gBACL;gBACA;gBACA;gBACA;YACF;YACA;QACF;IACF,EAAE,OAAO,OAAO;QACd,OAAO,2KAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAe,GAAG;YAAE,QAAQ;QAAI;IACpE;AACF"}}]
}